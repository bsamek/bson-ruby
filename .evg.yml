functions:
  'test':
    command: shell.exec
    params:
      working_dir: src
      script: |
        source ~/.rvm/scripts/rvm
        bash -l rvm install ruby-2.3.0
        bash -l rvm use 2.3.0
        bash -l gem install bundler
        bash -l bundle install
        bash -l bundle exec rake clean
        bash -l bundle exec rake compile
        bash -l bundle exec rake spec

tasks:
  - name: 'build'
    commands:
      - command: git.get_project
        params:
          directory: src
      - func: 'test'

buildvariants:
  - name: debian
    display_name: Debian 8.1 x86
    run_on:
      - debian81-test
    tasks:
      - name: 'build'
  - name: rhelzseries
    display_name: RHEL 7.2 Z-Series
    run_on:
      - rhel72-zseries-test
    tasks:
      - name: 'build'
  - name: rhelpower
    display_name: RHEL 7.1 PowerPC
    run_on:
      - rhel71-power8-test
    tasks:
      - name: 'build'
